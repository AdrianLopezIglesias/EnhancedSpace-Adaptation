<?xml version="1.0" encoding="utf-8" ?>
<Datatable xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xsi:noNamespaceSchemaLocation="../../Schemas/ModuleDefinition.xsd">
    <!-- LINK EXAMPLE
    <LinkEffect>
        <LinkedModuleConstraint>
            <PathPrerequisite Flags="Prerequisite">ClassModuleWeaponTest02</PathPrerequisite>
        </LinkedModuleConstraint>
        <OwnModifier>
            <SimulationDescriptorReference Name="ClassModuleOwnEffectOnDefense"/>
        </OwnModifier>
        <LinkedModuleModifier>
            <SimulationDescriptorReference Name="ClassModuleLinkedEffectOnWeapon"/>
        </LinkedModuleModifier>
    </LinkEffect>
    
    -LISTED TYPES CAN BE ATTACKED-
    <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
    </TargetSortingCriterion>
    <TargetSortingCriterion Name="Size">
        <ScoreModifier Name="ShipSizeSmall">1</ScoreModifier>
        <ScoreModifier Name="ShipSizeMedium">8</ScoreModifier>
        <ScoreModifier Name="ShipSizeLarge">16</ScoreModifier>
    </TargetSortingCriterion>
    <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
        <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
    </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    
    - Score modifier is used to spread out attacks between ships.
    
    PRE REQUISITE GUIDE:
    Edition = Not visible in ship designer.
    everything else : visible, but disabled.
    -->


    <!-- ********************* -->
    <!-- ** WEAPON MODULES  ** -->
    <!-- ********************* -->


    <!-- KINETIC -->
    <WeaponModule Name="ModuleWeaponKinetic1" Type="Kinetic" Family="KineticBase" Level="1">
        <Cost ResourceName="SystemProduction">80</Cost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
		<!-- Specific weapons -->
		<AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
		<AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
		<AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
		<AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
		<AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
		<!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
		<AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
		<AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
		<AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
		<AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
		<AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary1</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponKinetic1"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
            <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>

        <!-- Uncomment the following line to define the ModuleFlackTest as a slave of this module. 
                 - Slaves are linked to their master slot but won't be visible in the ship design. Their information will be part of their master's.
                 - Slaves will recieve modifiers from their slot and the links bound to their slot but they can't be used to unlock links effects. 
                 - Slaves' lifespan in battle is linked to their masters', so they can't be destroyed directly from an enemy attack. 
                 - Many slaves can be defined for a given module. 
                 - Slaves won't be displayed in battle. 
                 - There is no module type restriction for slaves (weapon, defense, support...). -->
        <SlaveModule Name="ModuleWeaponFlack1" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoKinetic1"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponKinetic2" Type="Kinetic" Family="KineticBase" Level="2">
      <Cost ResourceName="SystemProduction">160</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
      <!-- ** END AI DATA ** -->
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponKinetic3</TechnologyPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponKinetic2"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
         <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <SlaveModule Name="ModuleWeaponFlack2" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoKinetic2"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

    <WeaponModule Name="ModuleWeaponKinetic3" Type="Kinetic" Family="KineticBase" Level="3">
       <Cost ResourceName="SystemProduction">320</Cost>
       <!-- ** START AI DATA ** -->
       <!-- Weapons types -->
       <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
       <!-- Armor types -->
       <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
       <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
       <!-- Specific weapons -->
       <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
       <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
       <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
       <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
       <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
       <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
       <!-- Ranges -->
       <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
       <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
       <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
       <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
       <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
       <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
       <!-- ** END AI DATA ** -->
       <TechnologyPrerequisite Flags="Edition" >TechnologyStageMilitary3</TechnologyPrerequisite>
       <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
       <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
       <SimulationDescriptorReference Name="ClassModuleWeapon"/>
       <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
       <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
          <SimulationDescriptorReference Name="ModuleWeaponKinetic3"/>
       </CategorizedSimulationDescriptors>
       <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
          <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
       </CategorizedSimulationDescriptors>
       <BattleActionReference Name="Weapon_Initialize"/>
       <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
       <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
       <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
       <BattleActionReference Name="Weapon_SalvoLaunched"/>
       <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
       <BattleActionReference Name="Weapon_SalvoHitTarget"/>
       <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
       <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
       <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
       <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
       <SlaveModule Name="ModuleWeaponFlack3" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
       <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
       <SalvoReference Name="SalvoKinetic3"/>
       <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
       <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
       <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
       <TargetSortingCriterion Name="Type">
          <ScoreModifier Name="Ship">1</ScoreModifier>
       </TargetSortingCriterion>
       <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
          <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
       </TargetSortingCriterion_PropertyMultiplier>
       <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
       <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
          <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
          <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
       </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponKinetic2Strategic1" Type="Kinetic" Family="KineticBase" Level="4">
        <Cost ResourceName="SystemProduction">120</Cost>
        <!--<Cost ResourceName="Strategic1" Instant="true">1</Cost>-->
        <CustomCost ResourceName="Strategic1" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
        <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
         <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic1</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponKinetic2Strategic1"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
            <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic1">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic1"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <SlaveModule Name="ModuleWeaponFlack2Strategic1" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoKinetic2Strategic1"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponKinetic3Strategic1" Type="Kinetic" Family="KineticBase" Level="5">
      <Cost ResourceName="SystemProduction">120</Cost>
      <!--<Cost ResourceName="Strategic1" Instant="true">2</Cost>-->
      <CustomCost ResourceName="Strategic1" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponKinetic3</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
      <SimulationDescriptorReference Name="ModuleTypeStrategic" />
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponKinetic3Strategic1"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
         <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic1">
         <SimulationDescriptorReference Name="ModuleWeaponStrategic1"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <SlaveModule Name="ModuleWeaponFlack2Strategic1" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoKinetic3Strategic1"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

   <WeaponModule Name="ModuleWeaponKinetic4" Type="Kinetic" Family="KineticBase" Level="6">
      <Cost ResourceName="SystemProduction">640</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponKinetic5</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponKinetic4"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
         <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <SlaveModule Name="ModuleWeaponFlack4" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoKinetic4"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>
   
   <WeaponModule Name="ModuleWeaponKinetic3Strategic3" Type="Kinetic" Family="KineticBase" Level="7">
        <Cost ResourceName="SystemProduction">240</Cost>
        <!--<Cost ResourceName="Strategic3" Instant="true">1</Cost>-->
        <CustomCost ResourceName="Strategic3" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
        <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic3</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponKinetic3Strategic3"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
            <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic3">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic3"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <SlaveModule Name="ModuleWeaponFlack4" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoKinetic3Strategic3"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponKinetic4Strategic3" Type="Kinetic" Family="KineticBase" Level="8">
      <Cost ResourceName="SystemProduction">240</Cost>
      <!--<Cost ResourceName="Strategic3" Instant="true">2</Cost>-->
      <CustomCost ResourceName="Strategic3" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponKinetic3Strategic3</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
      <SimulationDescriptorReference Name="ModuleTypeStrategic" />
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponKinetic4Strategic3"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
         <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic3">
         <SimulationDescriptorReference Name="ModuleWeaponStrategic3"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <SlaveModule Name="ModuleWeaponFlack4" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoKinetic4Strategic3"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

   <WeaponModule Name="ModuleWeaponKinetic5" Type="Kinetic" Family="KineticBase" Level="9">
      <Cost ResourceName="SystemProduction">1280</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="UnlockAvailability" Inverted="true">AffinityGameplayTerrans</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">../ClassEmpire,AffinityGameplayTerrans</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary5</TechnologyPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponKinetic5"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
         <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <SlaveModule Name="ModuleWeaponFlack5" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoKinetic5"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

   <WeaponModule Name="ModuleWeaponKinetic4Terrans" Type="Kinetic" Family="KineticBase" Level="9">
      <Cost ResourceName="SystemProduction">1280</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="UnlockAvailability" Inverted="false">AffinityGameplayTerrans</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="false">../ClassEmpire,AffinityGameplayTerrans</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary5</TechnologyPrerequisite>

      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponKinetic4Terrans"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
         <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <SlaveModule Name="ModuleWeaponFlack4" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoKinetic4"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

   <WeaponModule Name="ModuleWeaponKinetic4Strategic5" Type="Kinetic" Family="KineticBase" Level="10">
      <Cost ResourceName="SystemProduction">540</Cost>
      <!--<Cost ResourceName="Strategic5" Instant="true">1</Cost>-->
      <CustomCost ResourceName="Strategic5" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic5</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
      <SimulationDescriptorReference Name="ModuleTypeStrategic" />
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponKinetic4Strategic5"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
         <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic5">
         <SimulationDescriptorReference Name="ModuleWeaponStrategic5"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <SlaveModule Name="ModuleWeaponFlack5" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoKinetic4Strategic5"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

   <WeaponModule Name="ModuleWeaponKinetic5Strategic5" Type="Kinetic" Family="KineticBase" Level="11">
      <Cost ResourceName="SystemProduction">520</Cost>
      <!--<Cost ResourceName="Strategic5" Instant="true">2</Cost>-->
      <CustomCost ResourceName="Strategic5" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Kinetic" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.25"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Bomber" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Fighter" Mode="Against" Value="0.25"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.85"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponKinetic4Strategic5</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ClassModuleFlakExplication"/>
      <SimulationDescriptorReference Name="ModuleTypeStrategic" />
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponKinetic5Strategic5"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponKinetic">
         <SimulationDescriptorReference Name="ClassModuleWeaponKinetic"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic5">
         <SimulationDescriptorReference Name="ModuleWeaponStrategic5"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponKinetic_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <SlaveModule Name="ModuleWeaponFlack6" CategoryForSimulationDescriptors="CategoryWeaponFlack"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoKinetic5Strategic5"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>


   
    <!-- ******************** -->
    <!-- **Base FLACK Weapons** -->
    <!-- ******************** -->
    <!-- Flack example: it's a standard weapon that can only target salvos. 
             - The property LineOfSightOverridenAngle can be used to override the slot's default angle. In that case, this flack will always shoot in every directions regardless of the slot it will be put in. 
             - IsHidden="true" means this module won't be displayed in the modules list during ship designs edition. -->
    <WeaponModule Name="ModuleWeaponFlack1" Type="Flack" IsHidden="true" Family="FlackHidden" LineOfSightOverridenAngle="360">
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleWeaponFlack"/>
        <SimulationDescriptorReference Name="ModuleWeaponFlack1"/>
        <BattleActionReference Name="Weapon_Initialize"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSalvo"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSquadron"/>
        <BattleActionReference Name="Flak_SalvoHitTarget"/>
        <BattleActionReference Name="Flak_SalvoPostHitTargetAgainstSquadron"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoFlack1"/>
        <AvailableRange RangeName="Flak" PenaltyPropertyName="ShortRangePenalty"/>
		<TargetSortingCriterion Name="Type">
			<ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="Squadron">1</ScoreModifier>
		</TargetSortingCriterion>
		<TargetSortingCriterion Name="Size">
			<ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronBomber">2</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronFighter">1</ScoreModifier>
		</TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-3</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponFlack2" Type="Flack" IsHidden="true" Family="FlackHidden" LineOfSightOverridenAngle="360">
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleWeaponFlack"/>
        <SimulationDescriptorReference Name="ModuleWeaponFlack2"/>
        <BattleActionReference Name="Weapon_Initialize"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSalvo"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSquadron"/>
        <BattleActionReference Name="Flak_SalvoHitTarget"/>
        <BattleActionReference Name="Flak_SalvoPostHitTargetAgainstSquadron"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoFlack2"/>
        <AvailableRange RangeName="Flak" PenaltyPropertyName="ShortRangePenalty"/>
		<TargetSortingCriterion Name="Type">
			<ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="Squadron">1</ScoreModifier>
		</TargetSortingCriterion>
		<TargetSortingCriterion Name="Size">
			<ScoreModifier Name="Salvo">3</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronBomber">2</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronFighter">1</ScoreModifier>
		</TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">2</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponFlack2Strategic1" Type="Flack" IsHidden="true" Family="FlackHidden" LineOfSightOverridenAngle="360">
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleWeaponFlack"/>
        <SimulationDescriptorReference Name="ModuleWeaponFlack2Strategic1"/>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSalvo"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSquadron"/>
        <BattleActionReference Name="Flak_SalvoHitTarget"/>
        <BattleActionReference Name="Flak_SalvoPostHitTargetAgainstSquadron"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoFlack2"/>
        <AvailableRange RangeName="Flak" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="Squadron">1</ScoreModifier>
        </TargetSortingCriterion>
		<TargetSortingCriterion Name="Size">
			<ScoreModifier Name="Salvo">3</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronBomber">2</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronFighter">1</ScoreModifier>
		</TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">2</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponFlack3" Type="Flack" IsHidden="true" Family="FlackHidden" LineOfSightOverridenAngle="360">
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleWeaponFlack"/>
        <SimulationDescriptorReference Name="ModuleWeaponFlack3"/>
        <BattleActionReference Name="Weapon_Initialize"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSalvo"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSquadron"/>
        <BattleActionReference Name="Flak_SalvoHitTarget"/>
        <BattleActionReference Name="Flak_SalvoPostHitTargetAgainstSquadron"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoFlack3"/>
        <AvailableRange RangeName="Flak" PenaltyPropertyName="ShortRangePenalty"/>
		<TargetSortingCriterion Name="Type">
			<ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="Squadron">1</ScoreModifier>
		</TargetSortingCriterion>
		<TargetSortingCriterion Name="Size">
			<ScoreModifier Name="Salvo">3</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronBomber">2</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronFighter">1</ScoreModifier>
		</TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">2</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponFlack3Strategic1" Type="Flack" IsHidden="true" Family="FlackHidden" LineOfSightOverridenAngle="360">
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleWeaponFlack"/>
        <SimulationDescriptorReference Name="ModuleWeaponFlack3Strategic1"/>
        <BattleActionReference Name="Weapon_Initialize"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSalvo"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSquadron"/>
        <BattleActionReference Name="Flak_SalvoHitTarget"/>
        <BattleActionReference Name="Flak_SalvoPostHitTargetAgainstSquadron"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoFlack3"/>
        <AvailableRange RangeName="Flak" PenaltyPropertyName="ShortRangePenalty"/>
		<TargetSortingCriterion Name="Type">
			<ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="Squadron">1</ScoreModifier>
		</TargetSortingCriterion>
		<TargetSortingCriterion Name="Size">
			<ScoreModifier Name="Salvo">3</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronBomber">2</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronFighter">1</ScoreModifier>
		</TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">2</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponFlack4" Type="Flack" IsHidden="true" Family="FlackHidden" LineOfSightOverridenAngle="360">
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleWeaponFlack"/>
        <SimulationDescriptorReference Name="ModuleWeaponFlack4"/>
        <BattleActionReference Name="Weapon_Initialize"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSalvo"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSquadron"/>
        <BattleActionReference Name="Flak_SalvoHitTarget"/>
        <BattleActionReference Name="Flak_SalvoPostHitTargetAgainstSquadron"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoFlack4"/>
        <AvailableRange RangeName="Flak" PenaltyPropertyName="ShortRangePenalty"/>
		<TargetSortingCriterion Name="Type">
			<ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="Squadron">1</ScoreModifier>
		</TargetSortingCriterion>
		<TargetSortingCriterion Name="Size">
			<ScoreModifier Name="Salvo">3</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronBomber">2</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronFighter">1</ScoreModifier>
		</TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">2</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponFlack5" Type="Flack" IsHidden="true" Family="FlackHidden" LineOfSightOverridenAngle="360">
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleWeaponFlack"/>
        <SimulationDescriptorReference Name="ModuleWeaponFlack5"/>
        <BattleActionReference Name="Weapon_Initialize"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSalvo"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSquadron"/>
        <BattleActionReference Name="Flak_SalvoHitTarget"/>
        <BattleActionReference Name="Flak_SalvoPostHitTargetAgainstSquadron"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoFlack5"/>
        <AvailableRange RangeName="Flak" PenaltyPropertyName="ShortRangePenalty"/>
		<TargetSortingCriterion Name="Type">
			<ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="Squadron">1</ScoreModifier>
		</TargetSortingCriterion>
		<TargetSortingCriterion Name="Size">
			<ScoreModifier Name="Salvo">3</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronBomber">2</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronFighter">1</ScoreModifier>
		</TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">2</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponFlack6" Type="Flack" IsHidden="true" Family="FlackHidden" LineOfSightOverridenAngle="360">
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ClassModuleWeaponFlack"/>
        <SimulationDescriptorReference Name="ModuleWeaponFlack6"/>
        <BattleActionReference Name="Weapon_Initialize"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSalvo"/>
		<BattleActionReference Name="Weapon_FlakSalvoLaunchedAgainstSquadron"/>
        <BattleActionReference Name="Flak_SalvoHitTarget"/>
        <BattleActionReference Name="Flak_SalvoPostHitTargetAgainstSquadron"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoFlack6"/>
        <AvailableRange RangeName="Flak" PenaltyPropertyName="ShortRangePenalty"/>
		<TargetSortingCriterion Name="Type">
			<ScoreModifier Name="Salvo">1</ScoreModifier>
			<ScoreModifier Name="Squadron">1</ScoreModifier>
		</TargetSortingCriterion>
		<TargetSortingCriterion Name="Size">
			<ScoreModifier Name="Salvo">3</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronBomber">2</ScoreModifier>
			<ScoreModifier Name="SquadronTypeSquadronFighter">1</ScoreModifier>
		</TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">2</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
    </WeaponModule>

    <!-- ******************** -->
    <!-- **Base MISSILE Weapons** -->
    <!-- ******************** -->

    <WeaponModule Name="ModuleWeaponMissile1" Type="Missile" Family="MissileBase" Level="1">
        <Cost ResourceName="SystemProduction">120</Cost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
		<!-- Specific weapons -->
		<AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
		<AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
		<AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
		<!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
		<AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
		<AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
		<AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
		<AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
		<AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary1</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponMissile1"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
            <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoMissile1"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponMissile2" Type="Missile" Family="MissileBase" Level="2">
        <Cost ResourceName="SystemProduction">240</Cost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponMissile2</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponMissile2"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
            <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoMissile2"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>


   <WeaponModule Name="ModuleWeaponMissile3" Type="Missile" Family="MissileBase" Level="3">
      <Cost ResourceName="SystemProduction">480</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary3</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponMissile3"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
         <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoMissile3"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>


   <WeaponModule Name="ModuleWeaponMissile2Strategic1" Type="Missile" Family="MissileBase" Level="4">
        <Cost ResourceName="SystemProduction">180</Cost>
        <!--<Cost ResourceName="Strategic1" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic1" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic1</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponMissile2Strategic1"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
            <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic1">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic1"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoMissile2Strategic1"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>


   <WeaponModule Name="ModuleWeaponMissile3Strategic1" Type="Missile" Family="MissileBase" Level="5">
      <Cost ResourceName="SystemProduction">180</Cost>
      <!--<Cost ResourceName="Strategic1" Instant="true">3</Cost>-->
      <CustomCost ResourceName="Strategic1" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponMissile2Strategic1</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <SimulationDescriptorReference Name="ModuleTypeStrategic" />
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponMissile3Strategic1"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
         <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic1">
         <SimulationDescriptorReference Name="ModuleWeaponStrategic1"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoMissile3Strategic1"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

   <WeaponModule Name="ModuleWeaponMissile4" Type="Missile" Family="MissileBase" Level="6">
      <Cost ResourceName="SystemProduction">800</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponMissile4</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponMissile4"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
         <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoMissile4"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

    <WeaponModule Name="ModuleWeaponMissile3Strategic3" Type="Missile" Family="MissileBase" Level="7">
        <Cost ResourceName="SystemProduction">360</Cost>
        <!--<Cost ResourceName="Strategic3" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic3" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic3</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponMissile3Strategic3"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
            <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic3">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic3"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoMissile3Strategic3"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponMissile4Strategic3" Type="Missile" Family="MissileBase" Level="8">
        <Cost ResourceName="SystemProduction">360</Cost>
        <!--<Cost ResourceName="Strategic3" Instant="true">3</Cost>-->
        <CustomCost ResourceName="Strategic3" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponMissile3Strategic3</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponMissile4Strategic3"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
            <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic3">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic3"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoMissile4Strategic3"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponMissile5" Type="Missile" Family="MissileBase" Level="9">
      <Cost ResourceName="SystemProduction">1400</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary5</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponMissile5"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
         <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoMissile5"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

    <WeaponModule Name="ModuleWeaponMissile4Strategic5" Type="Missile" Family="MissileBase" Level="10">
        <Cost ResourceName="SystemProduction">800</Cost>
        <!--<Cost ResourceName="Strategic5" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic5" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic5</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponMissile4Strategic5"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
            <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic5">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic5"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoMissile4Strategic5"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponMissile5Strategic5" Type="Missile" Family="MissileBase" Level="11">
        <Cost ResourceName="SystemProduction">800</Cost>
        <!--<Cost ResourceName="Strategic5" Instant="true">3</Cost>-->
        <CustomCost ResourceName="Strategic5" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="ProjectileWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="-1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Missile" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="1"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponMissile4Strategic5</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponMissile5Strategic5"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponMissile">
            <SimulationDescriptorReference Name="ClassModuleWeaponMissile"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic5">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic5"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponMissile_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoMissile5Strategic5"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>



    <!-- ******************** -->
    <!-- **Base LASER Weapons** -->
    <!-- ******************** -->

    <WeaponModule Name="ModuleWeaponLaser1" Type="Laser" Family="LaserBase" Level="1">
        <Cost ResourceName="SystemProduction">80</Cost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
		<!-- Specific weapons -->
		<AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
		<AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
		<AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
		<!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
		<AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
		<AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
		<AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
		<AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
		<AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary1</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponLaser1"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
            <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoLaser1"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponLaser2" Type="Laser" Family="LaserBase" Level="2">
        <Cost ResourceName="SystemProduction">320</Cost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponLaser3</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponLaser2"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
            <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoLaser2"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponLaser3" Type="Laser" Family="LaserBase" Level="3">
      <Cost ResourceName="SystemProduction">320</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="UnlockAvailability" Inverted="true">AffinityGameplayVampirilis</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">../ClassEmpire,AffinityGameplayVampirilis</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary3</TechnologyPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponLaser3"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
         <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoLaser3"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

   <WeaponModule Name="ModuleWeaponLaser2Vampirilis" Type="Laser" Family="LaserBase" Level="3">
      <Cost ResourceName="SystemProduction">140</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="UnlockAvailability" Inverted="false">AffinityGameplayVampirilis</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="false">../ClassEmpire,AffinityGameplayVampirilis</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary3</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponLaser2Vampirilis"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
         <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoLaser2"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

    <WeaponModule Name="ModuleWeaponLaser2Strategic2" Type="Laser" Family="LaserBase" Level="4">
        <Cost ResourceName="SystemProduction">140</Cost>
        <!--<Cost ResourceName="Strategic2" Instant="true">1</Cost>-->
        <CustomCost ResourceName="Strategic2" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic2</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponLaser2Strategic2"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
            <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic2">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic2"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoLaser2Strategic2"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>


    <WeaponModule Name="ModuleWeaponLaser3Strategic2" Type="Laser" Family="LaserBase" Level="5">
        <Cost ResourceName="SystemProduction">140</Cost>
        <!--<Cost ResourceName="Strategic2" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic2" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponLaser2Strategic2</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponLaser3Strategic2"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
            <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic2">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic2"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoLaser3Strategic2"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponLaser4" Type="Laser" Family="LaserBase" Level="6">
      <Cost ResourceName="SystemProduction">800</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponLaser5</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponLaser4"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
         <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoLaser4"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>
   
    <WeaponModule Name="ModuleWeaponLaser3Strategic4" Type="Laser" Family="LaserBase" Level="7">
        <Cost ResourceName="SystemProduction">240</Cost>
        <!--<Cost ResourceName="Strategic4" Instant="true">1</Cost>-->
        <CustomCost ResourceName="Strategic4" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic4</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponLaser3Strategic4"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
            <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic4">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic4"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoLaser3Strategic4"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponLaser4Strategic4" Type="Laser" Family="LaserBase" Level="8">
        <Cost ResourceName="SystemProduction">240</Cost>
        <!--<Cost ResourceName="Strategic4" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic4" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponLaser3Strategic4</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponLaser4Strategic4"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
            <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic4">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic4"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoLaser4Strategic4"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponLaser5" Type="Laser" Family="LaserBase" Level="9">
      <Cost ResourceName="SystemProduction">1400</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
      <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
      <!-- ** END AI DATA ** -->
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary5</TechnologyPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponLaser5"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
         <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoLaser5"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>
   
    <WeaponModule Name="ModuleWeaponLaser4Strategic6" Type="Laser" Family="LaserBase" Level="10">
        <Cost ResourceName="SystemProduction">520</Cost>
        <!--<Cost ResourceName="Strategic6" Instant="true">1</Cost>-->
        <CustomCost ResourceName="Strategic6" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic6</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponLaser4Strategic6"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
            <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic6">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic6"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoLaser4Strategic6"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponLaser5Strategic6" Type="Laser" Family="LaserBase" Level="11">
        <Cost ResourceName="SystemProduction">520</Cost>
        <!--<Cost ResourceName="Strategic6" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic6" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Laser" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.5"/>
        <AIBattleSituations Situation="Beam" Mode="Against" Value="0.5"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="0.5"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="0.75"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="0.75"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponLaser4Strategic6</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponLaser5Strategic6"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponLaser">
            <SimulationDescriptorReference Name="ClassModuleWeaponLaser"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic6">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic6"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponLaser_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoLaser5Strategic6"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>


    <!-- ******************** -->
    <!-- **Base BEAM Weapons** -->
    <!-- ******************** -->

    <WeaponModule Name="ModuleWeaponBeam1" Type="Beam" Family="BeamBase" Level="1">
        <Cost ResourceName="SystemProduction">60</Cost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
		<!-- Specific weapons -->
		<AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
		<AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
		<AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
		<!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
		<AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
		<AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
		<AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
		<AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
		<AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary1</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponBeam1"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
            <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoBeam1"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponBeam2" Type="Beam" Family="BeamBase" Level="2">
        <Cost ResourceName="SystemProduction">120</Cost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponBeam2</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponBeam2"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
            <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoBeam2"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponBeam3" Type="Beam" Family="BeamBase" Level="3">
      <Cost ResourceName="SystemProduction">240</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary3</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponBeam3"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
         <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoBeam3"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>


   <WeaponModule Name="ModuleWeaponBeam2Strategic2" Type="Beam" Family="BeamBase" Level="4">
        <Cost ResourceName="SystemProduction">90</Cost>
        <!--<Cost ResourceName="Strategic2" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic2" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic2</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponBeam2Strategic2"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
            <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic2">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic2"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoBeam2Strategic2"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>


    <WeaponModule Name="ModuleWeaponBeam3Strategic2" Type="Beam" Family="BeamBase" Level="5">
        <Cost ResourceName="SystemProduction">90</Cost>
        <!--<Cost ResourceName="Strategic2" Instant="true">3</Cost>-->
        <CustomCost ResourceName="Strategic2" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponBeam2Strategic2</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponBeam3Strategic2"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
            <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic2">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic2"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoBeam3Strategic2"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponBeam4" Type="Beam" Family="BeamBase" Level="6">
      <Cost ResourceName="SystemProduction">450</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponBeam4</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponBeam4"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
         <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoBeam4"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>
   
    <WeaponModule Name="ModuleWeaponBeam3Strategic4" Type="Beam" Family="BeamBase" Level="7">
        <Cost ResourceName="SystemProduction">180</Cost>
        <!--<Cost ResourceName="Strategic4" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic4" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic4</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponBeam3Strategic4"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
            <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic4">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic4"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoBeam3Strategic4"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>
   
    <WeaponModule Name="ModuleWeaponBeam4Strategic4" Type="Beam" Family="BeamBase" Level="8">
        <Cost ResourceName="SystemProduction">180</Cost>
        <!--<Cost ResourceName="Strategic4" Instant="true">3</Cost>-->
        <CustomCost ResourceName="Strategic4" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponBeam3Strategic4</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponBeam4Strategic4"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
            <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic4">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic4"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoBeam4Strategic4"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

   <WeaponModule Name="ModuleWeaponBeam5" Type="Beam" Family="BeamBase" Level="9">
      <Cost ResourceName="SystemProduction">1000</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="UnlockAvailability" Inverted="true">AffinityGameplayTimeLords</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">../ClassEmpire,AffinityGameplayTimeLords</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary5</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponBeam5"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
         <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoBeam5"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

   <WeaponModule Name="ModuleWeaponBeam5TimeLords" Type="Beam" Family="BeamBase" Level="9">
      <Cost ResourceName="SystemProduction">960</Cost>
      <!-- ** START AI DATA ** -->
      <!-- Weapons types -->
      <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
      <!-- Armor types -->
      <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
      <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
      <!-- Specific weapons -->
      <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
      <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
      <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
      <!-- Ranges -->
      <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
      <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
      <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
      <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
      <!-- ** END AI DATA ** -->
      <PathPrerequisite Flags="UnlockAvailability" Inverted="false">AffinityGameplayTimeLords</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="false">../ClassEmpire,AffinityGameplayTimeLords</PathPrerequisite>
      <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
      <TechnologyPrerequisite Flags="Edition">TechnologyStageMilitary5</TechnologyPrerequisite>
      <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
      <SimulationDescriptorReference Name="ClassModuleWeapon"/>
      <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
         <SimulationDescriptorReference Name="ModuleWeaponBeam5TimeLords"/>
      </CategorizedSimulationDescriptors>
      <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
         <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
      </CategorizedSimulationDescriptors>
      <BattleActionReference Name="Weapon_Initialize"/>
      <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
      <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
      <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
      <BattleActionReference Name="Weapon_SalvoLaunched"/>
      <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
      <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
      <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
      <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
      <SalvoReference Name="SalvoBeam5"/>
      <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
      <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
      <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
      <TargetSortingCriterion Name="Type">
         <ScoreModifier Name="Ship">1</ScoreModifier>
      </TargetSortingCriterion>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
      <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
      <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
         <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
         <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
      </TargetSortingCriterion_PropertyMultiplier>
   </WeaponModule>

    <WeaponModule Name="ModuleWeaponBeam4Strategic6" Type="Beam" Family="BeamBase" Level="10">
        <Cost ResourceName="SystemProduction">390</Cost>
        <!--<Cost ResourceName="Strategic6" Instant="true">2</Cost>-->
        <CustomCost ResourceName="Strategic6" Instant="true">2 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyWeaponModuleStrategic6</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponBeam4Strategic6"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
            <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic6">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic6"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoBeam4Strategic6"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>

    <WeaponModule Name="ModuleWeaponBeam5Strategic6" Type="Beam" Family="BeamBase" Level="11">
        <Cost ResourceName="SystemProduction">390</Cost>
        <!--<Cost ResourceName="Strategic6" Instant="true">3</Cost>-->
        <CustomCost ResourceName="Strategic6" Instant="true">1 * (Property(StockLocation, @../ClassEmpire, ShipStrategicCostMultiplier, true) + Property(StockLocation, @ClassColonizedStarSystem, ShipStrategicCostMultiplier, true) )</CustomCost>
		<!-- ** START AI DATA ** -->
        <!-- Weapons types -->
        <AIBattleSituations Situation="EnergyWeapon" Mode="Use" Value="1"/>
		<!-- Armor types -->
        <AIBattleSituations Situation="EnergyDefense" Mode="Against" Value="-1"/>
        <AIBattleSituations Situation="ProjectileDefense" Mode="Against" Value="1"/>
        <!-- Specific weapons -->
        <AIBattleSituations Situation="Beam" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Kinetic" Mode="Against" Value="0.5"/>
        <AIBattleSituations Situation="Missile" Mode="Against" Value="-0.75"/>
        <AIBattleSituations Situation="Laser" Mode="Against" Value="-0.75"/>
        <!-- Ranges -->
        <AIBattleSituations Situation="Short" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Medium" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Long" Mode="Use" Value="1"/>
        <AIBattleSituations Situation="Short" Mode="Against" Value="1.25"/>
        <AIBattleSituations Situation="Medium" Mode="Against" Value="1.125"/>
        <AIBattleSituations Situation="Long" Mode="Against" Value="1"/>
		<!-- ** END AI DATA ** -->
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
        <TechnologyPrerequisite Flags="Edition">TechnologyCuriosityModuleWeaponBeam4Strategic6</TechnologyPrerequisite>
        <PathPrerequisite Flags="ShipHasDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleWeapon"/>
        <SimulationDescriptorReference Name="ModuleTypeStrategic" />
        <CategorizedSimulationDescriptors Category="CategoryBaseWeapon">
            <SimulationDescriptorReference Name="ModuleWeaponBeam5Strategic6"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponBeam">
            <SimulationDescriptorReference Name="ClassModuleWeaponBeam"/>
        </CategorizedSimulationDescriptors>
        <CategorizedSimulationDescriptors Category="CategoryModuleWeaponStrategic6">
            <SimulationDescriptorReference Name="ModuleWeaponStrategic6"/>
        </CategorizedSimulationDescriptors>
        <BattleActionReference Name="Weapon_Initialize"/>
        <BattleActionReference Name="Weapon_SalvoHitFlotillaShield"/>
        <BattleActionReference Name="Weapon_SalvoHitShipShield"/>
        <BattleActionReference Name="Weapon_SalvoApplyShieldDamage"/>
        <BattleActionReference Name="Weapon_SalvoLaunched"/>
        <BattleActionReference Name="Weapon_SalvoPrepareHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget"/>
        <BattleActionReference Name="Weapon_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="WeaponBeam_SalvoPostHitTarget_StatisticsRecording"/>
        <BattleActionReference Name="Weapon_UpdateAccuracyAfterMiss"/>
        <AttackPathPrerequisite Inverted="true">EncounterEntityStatusDisabled</AttackPathPrerequisite>
        <SalvoReference Name="SalvoBeam5Strategic6"/>
        <AvailableRange RangeName="Long" PenaltyPropertyName="LongRangePenalty"/>
        <AvailableRange RangeName="Medium" PenaltyPropertyName="MediumRangePenalty"/>
        <AvailableRange RangeName="Short" PenaltyPropertyName="ShortRangePenalty"/>
        <TargetSortingCriterion Name="Type">
            <ScoreModifier Name="Ship">1</ScoreModifier>
        </TargetSortingCriterion>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="OffensiveMilitaryPowerIfWeakestTargeting">-1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
        <TargetSortingCriterion Name="Role" ScoreModifiersDefaultValue="1" IgnoredWhenCheckingTargetValidity="true"/>
        <TargetSortingCriterion_PropertyMultiplier Name="PropertyMultiplier">
            <ScoreModifier Name="TargetersCount">-1</ScoreModifier>
            <ScoreModifier Name="TargetingWeightBonus">1</ScoreModifier>
        </TargetSortingCriterion_PropertyMultiplier>
    </WeaponModule>



    <!-- ******************** -->
    <!-- ** DESTRUCTION MODULES ** -->
    <!-- ******************** -->

    <DestructionModule Name="ModuleDestruction1" Type="Destruction" Family="DestructionBase" Level="1">
        <Cost ResourceName="SystemProduction">480</Cost>
        <TechnologyPrerequisite Flags="Edition">TechnologyDestructionModule</TechnologyPrerequisite>
        <InterpreterPrerequisite Flags="Edition">Path(Context, @'ClassShip,ShipRoleCarrier')</InterpreterPrerequisite>
        <GameSettingPrerequisite Flags="Prerequisite,Discard,Edition,UnlockAvailability">AllowSuperWeapons,True</GameSettingPrerequisite>
        <PathPrerequisite Flags="Edition" Inverted="true">ClassShip,CannotHaveWeapon</PathPrerequisite>
		<PathPrerequisite Flags="ShipHasWeaponModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleWeapon</PathPrerequisite>
        <PathPrerequisite Flags="ShipHasWeaponModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleSquadron</PathPrerequisite>
        <PathPrerequisite Flags="NoMoreThanOneDestructionModule,Edition,Disable" Inverted="true">ClassShip/ClassSection/ClassModuleDestruction</PathPrerequisite>
        <SimulationDescriptorReference Name="ClassModuleDestruction"/>
        <SimulationDescriptorReference Name="ModuleDestruction1"/>
        <SimulationDescriptorReference Name="ClassModuleDestructionEffect"/>
        <SalvoReference Name="SalvoKinetic1"/>
    </DestructionModule>

</Datatable>